#!/bin/sh
# shellcheck disable=SC1090
. "$HOME"/.zsh/11_locals.zsh
tcmd="$1"
shift


while true; do
  # probably useless, if fs is ok
  sync "$TODO_GLOBAL"/*
  # still got the bug with 0.4 under heavy load with only one sync
  sleep 0.4
  clear
  sync "$TODO_GLOBAL"/*
  # don't show done tasks
  $tcmd ls "$@" | grep -v '[[:digit:]]* x'
  inotifywait -qq -e create,modify "$TODO_GLOBAL"/* > /dev/null
done
